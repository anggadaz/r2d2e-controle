/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

/*
 * FuzzyEditor.java
 *
 * Created on 02/11/2010, 17:03:46
 */
package br.ufrn.controle.fuzzycontroller.view;

import br.ufrn.controle.fuzzycontroller.funcaopertinencia.FuncPertinence;
import br.ufrn.controle.fuzzycontroller.domain.FuzzyController;
import br.ufrn.controle.fuzzycontroller.shared.ConstantsFuzzy;
import java.awt.CardLayout;
import java.awt.Cursor;
import java.awt.Dimension;
import java.util.ArrayList;

/**
 *
 * @author allan
 */
public class FuzzyEditor extends javax.swing.JDialog {

//    private FuzzyController controller;
    private MainView frame;

    /** Creates new form FuzzyEditor */
    public FuzzyEditor(MainView parent, boolean modal) {
        super(parent, modal);
        initComponents();
        this.frame = parent;

//        controller = parent.getControllerSelected();
//        ruleEditorPanel1.setController(controller);

        controlerPanel1.setParent(parent);
        controlerPanel1.preencheLista(parent.getControllers());

        setMinimumSize(new Dimension(941, 400));

    }

    public void init() {
        controlerPanel1.preencheLista(frame.getControllers());
    }

    /** This method is called from within the constructor to
     * initialize the form.
     * WARNING: Do NOT modify this code. The content of this method is
     * always regenerated by the Form Editor.
     */
    @SuppressWarnings("unchecked")
    // <editor-fold defaultstate="collapsed" desc="Generated Code">//GEN-BEGIN:initComponents
    private void initComponents() {

        jPanel6 = new javax.swing.JPanel();
        jPanel1 = new javax.swing.JPanel();
        panelConf = new javax.swing.JPanel();
        controlerPanel1 = new br.ufrn.controle.fuzzycontroller.view.ControlerPanel();
        panelFunc = new javax.swing.JPanel();
        iOPanel1 = new br.ufrn.controle.fuzzycontroller.view.IOPanel();
        panelRules = new javax.swing.JPanel();
        ruleEditorPanel1 = new br.ufrn.controle.fuzzycontroller.view.RuleEditorPanel();
        gradientPanel1 = new br.ufrn.siga.component.gradient.GradientPanel();
        buttonConf = new br.ufrn.siga.component.translucent.TranslucentButton();
        buttonFuncs = new br.ufrn.siga.component.translucent.TranslucentButton();
        buttonRules = new br.ufrn.siga.component.translucent.TranslucentButton();

        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);

        jPanel6.setBackground(new java.awt.Color(255, 255, 255));

        jPanel1.setLayout(new java.awt.CardLayout());

        panelConf.setBackground(new java.awt.Color(255, 255, 255));

        javax.swing.GroupLayout panelConfLayout = new javax.swing.GroupLayout(panelConf);
        panelConf.setLayout(panelConfLayout);
        panelConfLayout.setHorizontalGroup(
            panelConfLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(panelConfLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(controlerPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 753, Short.MAX_VALUE)
                .addContainerGap())
        );
        panelConfLayout.setVerticalGroup(
            panelConfLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panelConfLayout.createSequentialGroup()
                .addContainerGap()
                .addComponent(controlerPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 353, Short.MAX_VALUE)
                .addContainerGap())
        );

        jPanel1.add(panelConf, "card4");

        panelFunc.setBackground(new java.awt.Color(255, 255, 255));
        panelFunc.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(153, 153, 153)), "Editor Função de Pertinencia"));

        javax.swing.GroupLayout panelFuncLayout = new javax.swing.GroupLayout(panelFunc);
        panelFunc.setLayout(panelFuncLayout);
        panelFuncLayout.setHorizontalGroup(
            panelFuncLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 763, Short.MAX_VALUE)
            .addGroup(panelFuncLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(panelFuncLayout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(iOPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 743, Short.MAX_VALUE)
                    .addContainerGap()))
        );
        panelFuncLayout.setVerticalGroup(
            panelFuncLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 351, Short.MAX_VALUE)
            .addGroup(panelFuncLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(panelFuncLayout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(iOPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 329, Short.MAX_VALUE)
                    .addContainerGap()))
        );

        jPanel1.add(panelFunc, "funcPertinenciaCard");

        panelRules.setBackground(new java.awt.Color(255, 255, 255));
        panelRules.setBorder(javax.swing.BorderFactory.createTitledBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(153, 153, 153)), "Editor de Regras"));

        javax.swing.GroupLayout panelRulesLayout = new javax.swing.GroupLayout(panelRules);
        panelRules.setLayout(panelRulesLayout);
        panelRulesLayout.setHorizontalGroup(
            panelRulesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 763, Short.MAX_VALUE)
            .addGroup(panelRulesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(javax.swing.GroupLayout.Alignment.TRAILING, panelRulesLayout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(ruleEditorPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 743, Short.MAX_VALUE)
                    .addContainerGap()))
        );
        panelRulesLayout.setVerticalGroup(
            panelRulesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 351, Short.MAX_VALUE)
            .addGroup(panelRulesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(panelRulesLayout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(ruleEditorPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 325, Short.MAX_VALUE)
                    .addGap(15, 15, 15)))
        );

        jPanel1.add(panelRules, "ruleEditorCard");

        gradientPanel1.setColor1(new java.awt.Color(255, 255, 255));
        gradientPanel1.setLayout(new java.awt.FlowLayout(java.awt.FlowLayout.RIGHT, 20, 5));

        buttonConf.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/ufrn/controle/fuzzycontroller/view/resources/tools48x48.png"))); // NOI18N
        buttonConf.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                buttonConfMouseClicked(evt);
            }
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                buttonConfMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                buttonConfMouseExited(evt);
            }
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                buttonConfMouseReleased(evt);
            }
        });

        javax.swing.GroupLayout buttonConfLayout = new javax.swing.GroupLayout(buttonConf);
        buttonConf.setLayout(buttonConfLayout);
        buttonConfLayout.setHorizontalGroup(
            buttonConfLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 48, Short.MAX_VALUE)
        );
        buttonConfLayout.setVerticalGroup(
            buttonConfLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 48, Short.MAX_VALUE)
        );

        gradientPanel1.add(buttonConf);

        buttonFuncs.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/ufrn/controle/fuzzycontroller/view/resources/area_empilhada_48x48.png"))); // NOI18N
        buttonFuncs.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                buttonFuncsMouseClicked(evt);
            }
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                buttonFuncsMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                buttonFuncsMouseExited(evt);
            }
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                buttonFuncsMouseReleased(evt);
            }
        });

        javax.swing.GroupLayout buttonFuncsLayout = new javax.swing.GroupLayout(buttonFuncs);
        buttonFuncs.setLayout(buttonFuncsLayout);
        buttonFuncsLayout.setHorizontalGroup(
            buttonFuncsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 48, Short.MAX_VALUE)
        );
        buttonFuncsLayout.setVerticalGroup(
            buttonFuncsLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 48, Short.MAX_VALUE)
        );

        gradientPanel1.add(buttonFuncs);

        buttonRules.setIcon(new javax.swing.ImageIcon(getClass().getResource("/br/ufrn/controle/fuzzycontroller/view/resources/gear48x48.png"))); // NOI18N
        buttonRules.addMouseListener(new java.awt.event.MouseAdapter() {
            public void mouseClicked(java.awt.event.MouseEvent evt) {
                buttonRulesMouseClicked(evt);
            }
            public void mouseEntered(java.awt.event.MouseEvent evt) {
                buttonRulesMouseEntered(evt);
            }
            public void mouseExited(java.awt.event.MouseEvent evt) {
                buttonRulesMouseExited(evt);
            }
            public void mouseReleased(java.awt.event.MouseEvent evt) {
                buttonRulesMouseReleased(evt);
            }
        });

        javax.swing.GroupLayout buttonRulesLayout = new javax.swing.GroupLayout(buttonRules);
        buttonRules.setLayout(buttonRulesLayout);
        buttonRulesLayout.setHorizontalGroup(
            buttonRulesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 48, Short.MAX_VALUE)
        );
        buttonRulesLayout.setVerticalGroup(
            buttonRulesLayout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGap(0, 48, Short.MAX_VALUE)
        );

        gradientPanel1.add(buttonRules);

        javax.swing.GroupLayout jPanel6Layout = new javax.swing.GroupLayout(jPanel6);
        jPanel6.setLayout(jPanel6Layout);
        jPanel6Layout.setHorizontalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(gradientPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 773, Short.MAX_VALUE)
                .addContainerGap())
            .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel6Layout.createSequentialGroup()
                    .addContainerGap()
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 773, Short.MAX_VALUE)
                    .addContainerGap()))
        );
        jPanel6Layout.setVerticalGroup(
            jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addGroup(jPanel6Layout.createSequentialGroup()
                .addContainerGap()
                .addComponent(gradientPanel1, javax.swing.GroupLayout.PREFERRED_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.PREFERRED_SIZE)
                .addContainerGap(397, Short.MAX_VALUE))
            .addGroup(jPanel6Layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
                .addGroup(jPanel6Layout.createSequentialGroup()
                    .addGap(80, 80, 80)
                    .addComponent(jPanel1, javax.swing.GroupLayout.DEFAULT_SIZE, 375, Short.MAX_VALUE)
                    .addContainerGap()))
        );

        javax.swing.GroupLayout layout = new javax.swing.GroupLayout(getContentPane());
        getContentPane().setLayout(layout);
        layout.setHorizontalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );
        layout.setVerticalGroup(
            layout.createParallelGroup(javax.swing.GroupLayout.Alignment.LEADING)
            .addComponent(jPanel6, javax.swing.GroupLayout.DEFAULT_SIZE, javax.swing.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
        );

        pack();
    }// </editor-fold>//GEN-END:initComponents

    private void buttonConfMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonConfMouseClicked
    }//GEN-LAST:event_buttonConfMouseClicked

    private void buttonRulesMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonRulesMouseClicked
    }//GEN-LAST:event_buttonRulesMouseClicked

    private void buttonFuncsMouseClicked(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonFuncsMouseClicked
    }//GEN-LAST:event_buttonFuncsMouseClicked

    private void buttonConfMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonConfMouseEntered
        buttonConf.setCursor(new Cursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_buttonConfMouseEntered

    private void buttonFuncsMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonFuncsMouseEntered
        buttonFuncs.setCursor(new Cursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_buttonFuncsMouseEntered

    private void buttonRulesMouseEntered(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonRulesMouseEntered
        buttonRules.setCursor(new Cursor(Cursor.HAND_CURSOR));
    }//GEN-LAST:event_buttonRulesMouseEntered

    private void buttonConfMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonConfMouseExited
        buttonConf.setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
    }//GEN-LAST:event_buttonConfMouseExited

    private void buttonFuncsMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonFuncsMouseExited
        buttonFuncs.setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
    }//GEN-LAST:event_buttonFuncsMouseExited

    private void buttonRulesMouseExited(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonRulesMouseExited
        buttonRules.setCursor(new Cursor(Cursor.DEFAULT_CURSOR));
    }//GEN-LAST:event_buttonRulesMouseExited

    private void buttonFuncsMouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonFuncsMouseReleased
        // TODO add your handling code here:
        iOPanel1.clear();

        FuzzyController fc = controlerPanel1.getSelectedFunc();

        if (fc == null) {
            return;
        }

        iOPanel1.setController(fc);

        for (String type : fc.getDataInType()) {
            ArrayList<FuncPertinence> funcs = fc.getInference().getDataBase().getIn(type);
            ArrayList<Double> ranges = fc.getInference().getDataBase().getRangeIn(type);
            String range;
            if (ranges != null) {
                range = ranges.get(0).toString() + " " + ranges.get(1).toString();
            } else {
                range = "";
            }
            iOPanel1.addIn(funcs, type, range);
        }

        ArrayList<FuncPertinence> funcs = fc.getInference().getDataBase().getOut(ConstantsFuzzy.VARIABLE_OUTPUT);

        ArrayList<Double> ranges = fc.getInference().getDataBase().getRangeOut(ConstantsFuzzy.VARIABLE_OUTPUT);
        String range;
        if (ranges != null) {
            range = ranges.get(0).toString() + " " + ranges.get(1).toString();
        } else {
            range = "";
        }

        if (funcs != null) {
            iOPanel1.addOut(funcs, ConstantsFuzzy.VARIABLE_OUTPUT, range);
        }

        iOPanel1.getFuncPanel1().getFuncaoPertinenciaPanel1().repaint();

        CardLayout carta = ((CardLayout) jPanel1.getLayout());
        carta.show(jPanel1, "funcPertinenciaCard");
    }//GEN-LAST:event_buttonFuncsMouseReleased

    private void buttonConfMouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonConfMouseReleased
        // TODO add your handling code here:
        CardLayout carta = ((CardLayout) jPanel1.getLayout());
        carta.show(jPanel1, "card4");
    }//GEN-LAST:event_buttonConfMouseReleased

    private void buttonRulesMouseReleased(java.awt.event.MouseEvent evt) {//GEN-FIRST:event_buttonRulesMouseReleased
        // TODO add your handling code here:
        FuzzyController fc = controlerPanel1.getSelectedFunc();
        
        if (fc == null) {
            return;
        }

        ruleEditorPanel1.setController(fc);

        CardLayout carta = ((CardLayout) jPanel1.getLayout());
        carta.show(jPanel1, "ruleEditorCard");
    }//GEN-LAST:event_buttonRulesMouseReleased

    /**
     * @param args the command line arguments
     */
    public static void main(String args[]) {
        java.awt.EventQueue.invokeLater(new Runnable() {

            public void run() {
                FuzzyEditor dialog = new FuzzyEditor(new MainView(), true);
                dialog.addWindowListener(new java.awt.event.WindowAdapter() {

                    public void windowClosing(java.awt.event.WindowEvent e) {
                        System.exit(0);
                    }
                });
                dialog.setVisible(true);
            }
        });
    }
    // Variables declaration - do not modify//GEN-BEGIN:variables
    private br.ufrn.siga.component.translucent.TranslucentButton buttonConf;
    private br.ufrn.siga.component.translucent.TranslucentButton buttonFuncs;
    private br.ufrn.siga.component.translucent.TranslucentButton buttonRules;
    private br.ufrn.controle.fuzzycontroller.view.ControlerPanel controlerPanel1;
    private br.ufrn.siga.component.gradient.GradientPanel gradientPanel1;
    private br.ufrn.controle.fuzzycontroller.view.IOPanel iOPanel1;
    private javax.swing.JPanel jPanel1;
    private javax.swing.JPanel jPanel6;
    private javax.swing.JPanel panelConf;
    private javax.swing.JPanel panelFunc;
    private javax.swing.JPanel panelRules;
    private br.ufrn.controle.fuzzycontroller.view.RuleEditorPanel ruleEditorPanel1;
    // End of variables declaration//GEN-END:variables
}
